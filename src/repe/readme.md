modified from https://github.com/andyzoujm/representation-engineering
